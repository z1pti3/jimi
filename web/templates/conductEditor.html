<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta charset="utf-8" />
		<title></title>
		<script src="{{ url_for('static', filename='includes/jquery/js/jquery-3.4.1.js') }}"></script>
		<script src="{{ url_for('static', filename='includes/jquery/js/jquery-ui-1.12.1.js') }}"></script>

		<link rel="stylesheet" href="{{ url_for('static', filename='includes/jquery/css/jquery-ui.theme.css') }}">
		<link rel="stylesheet" href="{{ url_for('static', filename='includes/jquery/css/jquery-ui.css') }}">
		<link rel="stylesheet" href="{{ url_for('static', filename='includes/jquery/css/jquery-ui.structure.css') }}">

		<link rel="stylesheet" href="{{ url_for('static', filename='includes/bootstrap-3.3.7/css/bootstrap.min.css') }}">
		<script src="{{ url_for('static', filename='includes/bootstrap-3.3.7/js/bootstrap.min.js') }}"></script>

		<link rel="stylesheet" href="{{ url_for('static', filename='css/datatable.css') }}">

		<script src="{{ url_for('static', filename='includes/visjs/js/vis-network.min.js') }}"></script>

		<script src="{{ url_for('static', filename='javascript/helpers.js') }}"></script>
		<script src="{{ url_for('static', filename='javascript/flow.js') }}"></script>
		<script src="{{ url_for('static', filename='javascript/objectProperties.js') }}"></script>
		<script src="{{ url_for('static', filename='javascript/linkProperties.js') }}"></script>
		<script src="{{ url_for('static', filename='javascript/newObject.js') }}"></script>
		<script src="{{ url_for('static', filename='javascript/alert.js') }}"></script>
		<script src="{{ url_for('static', filename='javascript/existingObject.js') }}"></script>
		<script src="{{ url_for('static', filename='javascript/triggerObject.js') }}"></script>
		<script src="{{ url_for('static', filename='javascript/uiACLProperties.js') }}"></script>

		<link rel="stylesheet" href="{{ url_for('static', filename='css/conductEditor.css') }}">
		<link rel="stylesheet" href="{{ url_for('static', filename='css/objectProperties.css') }}">
		<link rel="stylesheet" href="{{ url_for('static', filename='css/alert.css') }}">

		<link rel="stylesheet" href="{{ url_for('static', filename='themes/default/default.css') }}">

	</head>
	<body>
		<div class="ui-container">
			<button onclick="createNewObjectPanel()" class="newModelObject">+</button>
			<div class="ui-main">
				<!-- Right Click Menu -->
				<ul id="contextMenu" class="dropdown-menu" role="menu" style="display:none" >
					<li><a tabindex="-1" onclick="editFlowObject()">Edit</a></li>
					<li><a tabindex="-1" onclick="copyFlowObject()">Copy</a></li>
					<li class="divider"></li>
					<li><a tabindex="-1" onclick="duplicateFlowObject()">Duplicate</a></li>
					<li class="divider"></li>
					<li><a tabindex="-1" onclick="triggerFlowObject()">Trigger</a></li>
					<li class="divider"></li>
					<li><a tabindex="-1" onclick="editFlowACL()">Modify UI ACL</a></li>
					<li class="divider"></li>
					<li><a tabindex="-1" onclick="deleteFlowObject()">Delete</a></li>
				</ul>
				<div class="flowchart theme-content" id="flowchart"></div>
			</div>
		</div>
	</body>
</html>

<script>
	var CSRF = "{{CSRF}}"
  </script>

<!-- Right Click Menu -->
<script>
	(function ($, window) {
		$.fn.contextMenu = function (settings) {
			return this.each(function () {
				// Open context menu
				$(this).on("contextmenu", function (e) {
					// return native menu if pressing control
					if (e.ctrlKey) return;
					
					//open menu
					if (selectedObject)
					{
						var $menu = $(settings.menuSelector)
							.data("invokedOn", $(e.target))
							.show()
							.css({
								position: "absolute",
								left: getMenuPosition(e.clientX, 'width', 'scrollLeft'),
								top: getMenuPosition(e.clientY, 'height', 'scrollTop')
							})
							.off('click')
							.on('click', 'a', function (e) {
								$menu.hide();
						
								var $invokedOn = $menu.data("invokedOn");
								var $selectedMenu = $(e.target);
								
								//settings.menuSelected.call(this, $invokedOn, $selectedMenu);
							});
					}
					
					return false;
				});

				//make sure menu closes on any click
				$('body').click(function () {
					$(settings.menuSelector).hide();
				});
			});
			
			function getMenuPosition(mouse, direction, scrollDir) {
				var win = $(window)[direction](),
					scroll = $(window)[scrollDir](),
					menu = $(settings.menuSelector)[direction](),
					position = mouse + scroll;
							
				// opening menu would pass the side of the page
				if (mouse + menu > win && menu < mouse) 
					position -= menu;
				
				return position;
			}    

	};
	})(jQuery, window);
	$(".flowchart").contextMenu({menuSelector: "#contextMenu" });
</script>

